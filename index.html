<!DOCTYPE html>
<html>
  <head>
    <title>Formulář pro imaginární nákup </title>
    <link rel="stylesheet" type="text/css" href="style.css">

  </head>
  <body>
    <h1>Formulář pro imaginární nákup</h1>
    
    <form method="post" action="summary.html">

		<label for="jmeno">Jméno:</label>
		<input type="text" id="jmeno" name="jmeno" required><br>

      <h2>Nejlepší produkt na světě</h2>
      <p>Cena: 300 Kč</p>
      <label for="produkt3-kusy">Počet kusů:</label>
      <input type="number" id="produkt3-kusy" name="produkt3-kusy" value="0" min="0"><br>
      <h2 id="celkova-cena">Celková cena: <span id="celkem">0</span> Kč</h2>
      <label for="mena">Volba jiné měny:</label>
      <select id="mena" onchange="aktualizovatCenu()">
        <option value="CZK" selected>Kč</option>
        <option value="USD">USD</option>
        <option value="EUR">EUR</option>
        <option value="GBP">GBP</option>
      </select>

      <h4>Cena bez DPH: <span id="bez-dph">0</span> Kč</h4>
      <h4>Celková cena v libovolné měně: <span id="currencyDisplay">0</span> </h4>
      <h4>Před odesláním formuláře si zkontrolujte zadané údaje, později to již nebude možné. </h4>

      
      <button type="button" onclick="zobrazitRekapitulaci()">Zobrazit rekapitulaci</button>

    </form>
  
    <script>

const currency = 'EUR';
const url = 'https://api.exchangerate-api.com/v4/latest/CZK';


const exchangeRates = {};


fetch(url)
  .then(response => response.json())
  .then(data => {
    exchangeRates['CZK'] = 1;
    exchangeRates['USD'] = data.rates['USD'];
    exchangeRates['EUR'] = data.rates['EUR'];
    exchangeRates['GBP'] = data.rates['GBP'];
  })
  .catch(error => {
    console.error(error);
    kurzElement.innerHTML = 'Nepodařilo se načíst kurz';
  });


const produkt3Kusy = document.getElementById('produkt3-kusy');
const celkem = document.getElementById('celkem');
const celkemBezDPH = document.getElementById('bez-dph');
const dph = 21;
const celkovaCena = 0;

function aktualizovatCenu() {
  const cenaProdukt3 = 300;
  const pocetProdukt3 = parseInt(produkt3Kusy.value);

  const celkovaCena = pocetProdukt3 * cenaProdukt3;
  const cenaBezDPH = celkovaCena / (1 + dph / 100);
  const cenaSDPH = celkovaCena * (1 + dph / 100);

  const selectedCurrency = document.getElementById('mena').value;
  const exchangeRate = exchangeRates[selectedCurrency];
  const totalPrice = celkovaCena * exchangeRate;

  celkem.innerHTML = celkovaCena;
  celkemBezDPH.innerHTML = cenaBezDPH.toFixed(2);
  currencyDisplay.innerHTML = totalPrice.toFixed(2) + ' ' + selectedCurrency;

}

function zobrazitRekapitulaci() {
  window.location.href = "summary.html";
}

produkt3Kusy.addEventListener('input', aktualizovatCenu);

</script>

  </body>
</html>
